<!DOCTYPE html>
<html>
<head>
	<style>
		body {
			font-family: sans-serif;
		}
		.header {
			display: flex;
			column-gap: 20px;
		}
		.footer {
			font-size: x-small;
		}
		#content {
			display: flex;
		}
		#posted-container {
			flex-direction: column;
			flex: 1 0 15%;
		}
		#entries-container {
			flex-direction: column;
			flex: 1 0 50%;
		}
		#tags-container {
			flex: 1 0 20%;
		}
	</style>

</head>
<body onload='onloadHandler()'>
	<div class='header'>
		<img src='cancelled.png' height='100'/>
		<h1>Its Tradeoffs All The Way Down</h1>
	</div>
	<hr>
	<div id='content'>
		<div id='posted-container'>
			<h2>Posted</h2>
			<div id='posted' class='posted'>
			</div>
		</div>
		<div id='entries-container'>
			<h2>Entries</h2>
			<div id='entries' class='entries'>
			</div>
		</div>
		<div id='tags-container'>
			<h2>Tags</h2>
			<div id='tags' class='tags'>
			</div>
		</div>
	</div>
	<hr>
	<div class='footer'>
		<p>Legal blah blah...
		</p>
		<p>all words on this page are my own unless they are distinguished as quotes.  All thoughts are my own, and dont reflect those of my employers or others.
		</p>
		<p>Having said that, I owe a huge debt to others for developing these thoughts in the first place.  Thanks for all the conversations, grumpy, cynical, and otherwise!
		</p>
		<p>I own the copyright to all the text, and reserve all rights.
		</p>
	</div>

	<script>
		/*
		Entry {
			id, title, body, posted
		}
		*/
		function onloadHandler() {
			// console.log(">>>onloadHandler");

			var xmlHttp = new XMLHttpRequest();
			xmlHttp.onreadystatechange = function() {
				if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
					cbRefreshEntries(xmlHttp.responseText);
				}
			}
			xmlHttp.open("GET", "/entries", true); // true for asynchronous 
			xmlHttp.send(null);
		}

		function cbRefreshEntries(rsp) {
			// console.log(">>>cbRefreshEntries");

			if (rsp.length == 0) {
				return;
			}

			arr = JSON.parse(rsp);
			if (typeof entries != "object") {
				return;
			}

			posted = document.getElementById("posted");
			entries = document.getElementById("entries");

			while (posted.firstChild) {
				posted.removeChild(posted.lastChild)
			}
			while (entries.firstChild) {
				entries.removeChild(entries.lastChild)
			}
			postedHtml = ""
			entriesHtml = ""
			for (ii = 0; ii < arr.length; ii++) {
				postedHtml += addPostedHtml(arr[ii])
				entriesHtml += addEntryHtml(arr[ii])
			}
			posted.innerHTML = postedHtml;
			entries.innerHTML = entriesHtml;
		}

		function addPostedHtml(entry) {
			html = "<a href='#e-" + entry.id + "'>" + entry.posted + "</a>\n";
			html += "<br>\n";

			return html;
		}

		function addEntryHtml(entry) {
			return "<p id='e-" + entry.id + "'>" + entry.body + "</p>\n";
		}
	</script>
</body>
</html>
